{"paragraphs":[{"text":"%md\nApache Spark adalah sebuah framework big data yang cukup populer dan lengkap yang dapat berjalan diatas Hadoop maupun bukan Hadoop. Spark dapat digunakan untuk berbagai keperluan dalam pengolahan data, seperti data cleaning, data preparation, stream processing, hingga machine learning. Spark memiliki berbagai interface seperti Scala (API aslinya), Python, Java, R dan SQL.\nPada bagian ini kita akan mempelajari bagaimana memulai menggunakan Apache Spark dengan cara yang mudah yaitu menggunakan pySpark dan Dataframe API untuk melakukan analisa pengguna sederhana. Hal-hal yang dipelajari dalam pySpark adalah:\n- membaca data berformat csv\n- melakukan agregasi dan join \n- melakukan perhitungan summary statistik\nKita akan menggunakan movielens dataset yang telah diupload ke dalam HDFS, sebagaimana yang telah dijelaskan pada artikel sebelumnya.","user":"yava","dateUpdated":"2020-05-08T06:10:27-0400","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<p>Apache Spark adalah sebuah framework big data yang cukup populer dan lengkap yang dapat berjalan diatas Hadoop maupun bukan Hadoop. Spark dapat digunakan untuk berbagai keperluan dalam pengolahan data, seperti data cleaning, data preparation, stream processing, hingga machine learning. Spark memiliki berbagai interface seperti Scala (API aslinya), Python, Java, R dan SQL.<br/>Pada bagian ini kita akan mempelajari bagaimana memulai menggunakan Apache Spark dengan cara yang mudah yaitu menggunakan pySpark dan Dataframe API untuk melakukan analisa pengguna sederhana. Hal-hal yang dipelajari dalam pySpark adalah:<br/>- membaca data berformat csv<br/>- melakukan agregasi dan join<br/>- melakukan perhitungan summary statistik<br/>Kita akan menggunakan movielens dataset yang telah diupload ke dalam HDFS, sebagaimana yang telah dijelaskan pada artikel sebelumnya.</p>\n</div>"}]},"apps":[],"jobName":"paragraph_1588693079042_184074926","id":"20200505-113759_1962504691","dateCreated":"2020-05-05T11:37:59-0400","dateStarted":"2020-05-08T06:10:27-0400","dateFinished":"2020-05-08T06:10:27-0400","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:6458"},{"text":"%md\n## Langkah-langkahnya\n\n#1. Pastikan dataset movielens telah berada pada direktori dataset dalam HDFS","user":"yava","dateUpdated":"2020-05-13T02:44:35-0400","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h2>Langkah-langkahnya</h2>\n<p>#1. Pastikan dataset movielens telah berada pada direktori dataset dalam HDFS</p>\n</div>"}]},"apps":[],"jobName":"paragraph_1588693083734_-600070441","id":"20200505-113803_1086970979","dateCreated":"2020-05-05T11:38:03-0400","dateStarted":"2020-05-13T02:44:35-0400","dateFinished":"2020-05-13T02:44:38-0400","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:6459"},{"text":"%sh\nhdfs dfs -ls dataset","user":"yava","dateUpdated":"2020-05-08T03:23:58-0400","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"sh","editOnDblClick":false,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/sh"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"SLF4J: Class path contains multiple SLF4J bindings.\nSLF4J: Found binding in [jar:file:/usr/yava/3.0.0.0-0000/hadoop/lib/slf4j-log4j12-1.7.25.jar!/org/slf4j/impl/StaticLoggerBinder.class]\nSLF4J: Found binding in [jar:file:/usr/yava/3.0.0.0-0000/tez/lib/slf4j-log4j12-1.7.10.jar!/org/slf4j/impl/StaticLoggerBinder.class]\nSLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.\nSLF4J: Actual binding is of type [org.slf4j.impl.Log4jLoggerFactory]\nFound 4 items\n-rw-r--r--   3 yava hdfs     197979 2020-05-01 12:20 dataset/links.csv\n-rw-r--r--   3 yava hdfs     494431 2020-05-01 12:20 dataset/movies.csv\n-rw-r--r--   3 yava hdfs    2483723 2020-05-01 12:20 dataset/ratings.csv\n-rw-r--r--   3 yava hdfs     118660 2020-05-01 12:20 dataset/tags.csv\n"}]},"apps":[],"jobName":"paragraph_1588922613082_-1088209837","id":"20200508-032333_368344195","dateCreated":"2020-05-08T03:23:33-0400","dateStarted":"2020-05-08T03:23:58-0400","dateFinished":"2020-05-08T03:24:03-0400","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:6460"},{"text":"%md\n#2. Melihat versi Apache Saprk yang digunakan. Langkah ini hanya opsional","user":"yava","dateUpdated":"2020-05-08T03:52:18-0400","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<p>#2. Melihat versi Apache Saprk yang digunakan. Langkah ini hanya opsional</p>\n</div>"}]},"apps":[],"jobName":"paragraph_1588693956485_836341933","id":"20200505-115236_1391709325","dateCreated":"2020-05-05T11:52:36-0400","dateStarted":"2020-05-08T03:52:18-0400","dateFinished":"2020-05-08T03:52:18-0400","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:6461"},{"text":"%spark.pyspark\nprint(\"Spark version : \" + spark.version)","user":"yava","dateUpdated":"2020-05-08T03:50:35-0400","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Spark version : 2.3.2\n"}]},"apps":[],"jobName":"paragraph_1588924229909_-420625460","id":"20200508-035029_1848690520","dateCreated":"2020-05-08T03:50:29-0400","dateStarted":"2020-05-08T03:50:35-0400","dateFinished":"2020-05-08T03:51:28-0400","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:6462"},{"text":"%spark.pyspark\n\nimport sys\nprint(\"Python version : \" + sys.version)\n","user":"yava","dateUpdated":"2020-05-08T03:51:36-0400","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Python version : 2.7.18 |Anaconda, Inc.| (default, Apr 23 2020, 22:42:48) \n[GCC 7.3.0]\n"}]},"apps":[],"jobName":"paragraph_1588695688149_-968443235","id":"20200505-122128_2018528441","dateCreated":"2020-05-05T12:21:28-0400","dateStarted":"2020-05-08T03:51:36-0400","dateFinished":"2020-05-08T03:51:37-0400","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:6463"},{"text":"%md\n#3. Membaca data datalens/rating.csv ke dalam spark dataframe","user":"yava","dateUpdated":"2020-05-08T03:53:22-0400","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<p>#3. Membaca data datalens/rating.csv ke dalam spark dataframe</p>\n</div>"}]},"apps":[],"jobName":"paragraph_1588924356634_-976032411","id":"20200508-035236_277682351","dateCreated":"2020-05-08T03:52:36-0400","dateStarted":"2020-05-08T03:53:22-0400","dateFinished":"2020-05-08T03:53:22-0400","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:6464"},{"text":"%spark.pyspark\nfrom pyspark.sql.types import *\n\nfile_path = \"hdfs://192.168.56.108/user/yava/dataset/ratings.csv\"\n\n\ndf_schema_ratings = StructType(\n  [StructField('userId', IntegerType()),\n   StructField('movieId', IntegerType()),\n   StructField('rating', DoubleType())]\n)\n\ndf_ratings = spark.read \\\n .option(\"delimiter\", \",\") \\\n .schema(df_schema_ratings) \\\n .option(\"inferSchema\", \"True\") \\\n .option(\"header\", \"True\") \\\n .csv(file_path)","user":"yava","dateUpdated":"2020-05-08T04:01:06-0400","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1588924296903_478190284","id":"20200508-035136_1752042955","dateCreated":"2020-05-08T03:51:36-0400","dateStarted":"2020-05-08T04:01:06-0400","dateFinished":"2020-05-08T04:01:10-0400","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:6465"},{"text":"%spark.pyspark\ndf_ratings.show(5)","user":"yava","dateUpdated":"2020-05-08T04:01:49-0400","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+------+-------+------+\n|userId|movieId|rating|\n+------+-------+------+\n|     1|      1|   4.0|\n|     1|      3|   4.0|\n|     1|      6|   4.0|\n|     1|     47|   5.0|\n|     1|     50|   5.0|\n+------+-------+------+\nonly showing top 5 rows\n\n"}]},"apps":[],"jobName":"paragraph_1588924782196_-1393766315","id":"20200508-035942_1729736993","dateCreated":"2020-05-08T03:59:42-0400","dateStarted":"2020-05-08T04:01:49-0400","dateFinished":"2020-05-08T04:01:56-0400","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:6466"},{"text":"%md\n#4. Bandingkan jumlah record pada dataframe dan file","user":"yava","dateUpdated":"2020-05-08T04:36:09-0400","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<p>#4. Bandingkan jumlah record pada dataframe dan file</p>\n</div>"}]},"apps":[],"jobName":"paragraph_1588926823326_954705503","id":"20200508-043343_1375589098","dateCreated":"2020-05-08T04:33:43-0400","dateStarted":"2020-05-08T04:36:09-0400","dateFinished":"2020-05-08T04:36:10-0400","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:6467"},{"text":"%spark.pyspark\ndf_ratings.count()","user":"yava","dateUpdated":"2020-05-08T04:31:54-0400","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"100836\n"}]},"apps":[],"jobName":"paragraph_1588926707213_-1424250001","id":"20200508-043147_163232061","dateCreated":"2020-05-08T04:31:47-0400","dateStarted":"2020-05-08T04:31:54-0400","dateFinished":"2020-05-08T04:31:55-0400","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:6468"},{"text":"%sh\nhdfs dfs -cat dataset/ratings.csv | wc -l","user":"yava","dateUpdated":"2020-05-08T04:33:17-0400","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"sh","editOnDblClick":false,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/sh"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"SLF4J: Class path contains multiple SLF4J bindings.\nSLF4J: Found binding in [jar:file:/usr/yava/3.0.0.0-0000/hadoop/lib/slf4j-log4j12-1.7.25.jar!/org/slf4j/impl/StaticLoggerBinder.class]\nSLF4J: Found binding in [jar:file:/usr/yava/3.0.0.0-0000/tez/lib/slf4j-log4j12-1.7.10.jar!/org/slf4j/impl/StaticLoggerBinder.class]\nSLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.\nSLF4J: Actual binding is of type [org.slf4j.impl.Log4jLoggerFactory]\n100837\n"}]},"apps":[],"jobName":"paragraph_1588926776195_1009571782","id":"20200508-043256_1727208370","dateCreated":"2020-05-08T04:32:56-0400","dateStarted":"2020-05-08T04:33:18-0400","dateFinished":"2020-05-08T04:33:24-0400","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:6469"},{"text":"%md\n#5. Menampilkan nilai statistik pada setiap kolom","user":"yava","dateUpdated":"2020-05-08T04:37:55-0400","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<p>#5. Menampilkan nilai statistik pada setiap kolom</p>\n</div>"}]},"apps":[],"jobName":"paragraph_1588926981019_-2100108598","id":"20200508-043621_46951243","dateCreated":"2020-05-08T04:36:21-0400","dateStarted":"2020-05-08T04:37:55-0400","dateFinished":"2020-05-08T04:37:55-0400","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:6470"},{"text":"%spark.pyspark\ndf_ratings.describe().show()","user":"yava","dateUpdated":"2020-05-08T04:38:18-0400","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python","editorHide":false,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-------+------------------+----------------+------------------+\n|summary|            userId|         movieId|            rating|\n+-------+------------------+----------------+------------------+\n|  count|            100836|          100836|            100836|\n|   mean|326.12756356856676|19435.2957177992| 3.501556983616962|\n| stddev| 182.6184914635004|35530.9871987003|1.0425292390606342|\n|    min|                 1|               1|               0.5|\n|    max|               610|          193609|               5.0|\n+-------+------------------+----------------+------------------+\n\n"}]},"apps":[],"jobName":"paragraph_1588927079004_-33301660","id":"20200508-043759_787033528","dateCreated":"2020-05-08T04:37:59-0400","dateStarted":"2020-05-08T04:38:18-0400","dateFinished":"2020-05-08T04:38:21-0400","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:6471"},{"text":"%md\n#6. Menampilkan nilai rating dan jumlahnya recordnya","user":"yava","dateUpdated":"2020-05-08T04:47:20-0400","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<p>#6. Menampilkan nilai rating dan jumlahnya recordnya</p>\n</div>"}]},"apps":[],"jobName":"paragraph_1588927172301_378340473","id":"20200508-043932_233671596","dateCreated":"2020-05-08T04:39:32-0400","dateStarted":"2020-05-08T04:47:20-0400","dateFinished":"2020-05-08T04:47:20-0400","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:6472"},{"text":"%spark.pyspark\n\nfrom pyspark.sql.functions import *\n\ndf_ratings \\\n    .groupBy(\"rating\") \\\n    .count() \\\n    .sort(asc(\"rating\")) \\\n    .show()\n","user":"yava","dateUpdated":"2020-05-08T04:45:41-0400","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+------+-----+\n|rating|count|\n+------+-----+\n|   0.5| 1370|\n|   1.0| 2811|\n|   1.5| 1791|\n|   2.0| 7551|\n|   2.5| 5550|\n|   3.0|20047|\n|   3.5|13136|\n|   4.0|26818|\n|   4.5| 8551|\n|   5.0|13211|\n+------+-----+\n\n"}]},"apps":[],"jobName":"paragraph_1588927177470_-1772126460","id":"20200508-043937_2143662441","dateCreated":"2020-05-08T04:39:37-0400","dateStarted":"2020-05-08T04:45:41-0400","dateFinished":"2020-05-08T04:45:44-0400","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:6473"},{"text":"%md\n#7 Menampilkan movieId = 356 beserta informasi min rating, max rating dan avg rating","user":"yava","dateUpdated":"2020-05-08T04:50:44-0400","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<p>#7 Menampilkan movieId = 356 beserta informasi min rating, max rating dan avg rating</p>\n</div>"}]},"apps":[],"jobName":"paragraph_1588927753654_-583269171","id":"20200508-044913_1776263936","dateCreated":"2020-05-08T04:49:13-0400","dateStarted":"2020-05-08T04:50:44-0400","dateFinished":"2020-05-08T04:50:44-0400","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:6474"},{"text":"%spark.pyspark\n356\n\ndf_ratings.filter(\"movieId = 296\") \\\n        .groupBy(\"movieId\") \\\n        .agg(min(\"rating\"), avg(\"rating\"), max(\"rating\")) \\\n        .show()","user":"yava","dateUpdated":"2020-05-08T05:40:25-0400","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-------+-----------+-----------------+-----------+\n|movieId|min(rating)|      avg(rating)|max(rating)|\n+-------+-----------+-----------------+-----------+\n|    296|        0.5|4.197068403908795|        5.0|\n+-------+-----------+-----------------+-----------+\n\n"}]},"apps":[],"jobName":"paragraph_1588927749585_727039386","id":"20200508-044909_1612927137","dateCreated":"2020-05-08T04:49:09-0400","dateStarted":"2020-05-08T05:40:25-0400","dateFinished":"2020-05-08T05:40:29-0400","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:6475"},{"text":"%md\n\n#8 Menampilkan user yang tidak menyukai movieId = 356","user":"yava","dateUpdated":"2020-05-08T06:05:47-0400","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<p>#8 Menampilkan user yang tidak menyukai movieId = 356</p>\n</div>"}]},"apps":[],"jobName":"paragraph_1588932308538_-2141528428","id":"20200508-060508_844838318","dateCreated":"2020-05-08T06:05:08-0400","dateStarted":"2020-05-08T06:05:47-0400","dateFinished":"2020-05-08T06:05:48-0400","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:6476"},{"text":"%spark.pyspark\n#berapa user yg tidak menyukai\n\ndf_ratings.filter(\"movieId = 296 and rating = 0.5\") \\\n        .show()","user":"yava","dateUpdated":"2020-05-08T05:44:37-0400","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+------+-------+------+\n|userId|movieId|rating|\n+------+-------+------+\n|   159|    296|   0.5|\n|   210|    296|   0.5|\n+------+-------+------+\n\n"}]},"apps":[],"jobName":"paragraph_1588930454625_-361975880","id":"20200508-053414_494625369","dateCreated":"2020-05-08T05:34:14-0400","dateStarted":"2020-05-08T05:44:37-0400","dateFinished":"2020-05-08T05:44:39-0400","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:6477"},{"text":"%md\n\n#9 Menampilkan film apa saja yang telah ditonton oleh user 210","user":"yava","dateUpdated":"2020-05-08T16:24:35-0400","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<p>#9 Menampilkan film apa saja yang telah ditonton oleh user 210</p>\n</div>"}]},"apps":[],"jobName":"paragraph_1588932353392_-1833502935","id":"20200508-060553_1594196153","dateCreated":"2020-05-08T06:05:53-0400","dateStarted":"2020-05-08T16:24:35-0400","dateFinished":"2020-05-08T16:24:35-0400","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:6478"},{"text":"%spark.pyspark\n#file apa saja yg dirating oleh user 210\n\ndf_ratings_user210 = df_ratings.filter(\"userId = 210\")\n\ndf_ratings_user210.show()","user":"yava","dateUpdated":"2020-05-08T05:46:51-0400","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+------+-------+------+\n|userId|movieId|rating|\n+------+-------+------+\n|   210|    153|   3.5|\n|   210|    260|   5.0|\n|   210|    296|   0.5|\n|   210|    435|   1.5|\n|   210|    485|   3.5|\n|   210|    589|   4.0|\n|   210|   1196|   5.0|\n|   210|   1198|   3.0|\n|   210|   1210|   5.0|\n|   210|   1270|   4.5|\n|   210|   1356|   4.5|\n|   210|   1527|   5.0|\n|   210|   1584|   4.0|\n|   210|   2011|   4.5|\n|   210|   2105|   2.5|\n|   210|   2571|   5.0|\n|   210|   2628|   5.0|\n|   210|   2716|   4.5|\n|   210|   3147|   4.0|\n|   210|   4299|   4.5|\n+------+-------+------+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1588931127693_-930578462","id":"20200508-054527_1550514962","dateCreated":"2020-05-08T05:45:27-0400","dateStarted":"2020-05-08T05:46:51-0400","dateFinished":"2020-05-08T05:46:52-0400","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:6479"},{"text":"%spark.pyspark\ndf_ratings_user210.count()","user":"yava","dateUpdated":"2020-05-08T05:48:06-0400","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"138\n"}]},"apps":[],"jobName":"paragraph_1588931278906_1064336949","id":"20200508-054758_1335668946","dateCreated":"2020-05-08T05:47:58-0400","dateStarted":"2020-05-08T05:48:07-0400","dateFinished":"2020-05-08T05:48:08-0400","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:6480"},{"text":"%md\n\n#10 Menampilkan judul film yang telah ditonton oleh user 210","user":"yava","dateUpdated":"2020-05-08T06:07:14-0400","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<p>#10 Menampilkan judul film yang telah ditonton oleh user 210</p>\n</div>"}]},"apps":[],"jobName":"paragraph_1588932397586_1299188749","id":"20200508-060637_1860611553","dateCreated":"2020-05-08T06:06:37-0400","dateStarted":"2020-05-08T06:07:14-0400","dateFinished":"2020-05-08T06:07:14-0400","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:6481"},{"text":"%spark.pyspark\n#untuk memperoleh judul film kita membutuhkan data movies\n\nfile_path = \"hdfs://192.168.56.108/user/yava/dataset/movies.csv\"\n\ndf_schema_movies = StructType(\n  [StructField('movieId', IntegerType()),\n   StructField('title', StringType()),\n   StructField('genres', StringType())]\n)\n\ndf_movies = spark.read \\\n .option(\"delimiter\", \",\") \\\n .schema(df_schema_movies) \\\n .option(\"inferSchema\", \"True\") \\\n .option(\"header\", \"True\") \\\n .csv(file_path)","user":"yava","dateUpdated":"2020-05-08T06:13:55-0400","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1588931305389_694693486","id":"20200508-054825_284957081","dateCreated":"2020-05-08T05:48:25-0400","dateStarted":"2020-05-08T05:52:37-0400","dateFinished":"2020-05-08T05:52:37-0400","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:6482"},{"text":"%spark.pyspark\n\ndf_movies.show(5)","user":"yava","dateUpdated":"2020-05-08T05:52:51-0400","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-------+--------------------+--------------------+\n|movieId|               title|              genres|\n+-------+--------------------+--------------------+\n|      1|    Toy Story (1995)|Adventure|Animati...|\n|      2|      Jumanji (1995)|Adventure|Childre...|\n|      3|Grumpier Old Men ...|      Comedy|Romance|\n|      4|Waiting to Exhale...|Comedy|Drama|Romance|\n|      5|Father of the Bri...|              Comedy|\n+-------+--------------------+--------------------+\nonly showing top 5 rows\n\n"}]},"apps":[],"jobName":"paragraph_1588931560201_394965550","id":"20200508-055240_1447469937","dateCreated":"2020-05-08T05:52:40-0400","dateStarted":"2020-05-08T05:52:51-0400","dateFinished":"2020-05-08T05:52:51-0400","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:6483"},{"text":"%spark.pyspark\n\ndf_movies.count()","user":"yava","dateUpdated":"2020-05-08T05:53:06-0400","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"9742\n"}]},"apps":[],"jobName":"paragraph_1588931574571_-1049046680","id":"20200508-055254_1619022623","dateCreated":"2020-05-08T05:52:54-0400","dateStarted":"2020-05-08T05:53:06-0400","dateFinished":"2020-05-08T05:53:06-0400","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:6484"},{"text":"%spark.pyspark\n#melakukan join antara data pengguna 210 dan data movies untuk memperoleh judul film \n\ndf_user210_movie = df_ratings_user210.join(df_movies, df_ratings_user210.movieId == df_movies.movieId)\\\n            .select(\"userId\", \"title\", \"rating\")","user":"yava","dateUpdated":"2020-05-08T06:14:38-0400","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1588931661580_935958014","id":"20200508-055421_709293532","dateCreated":"2020-05-08T05:54:21-0400","dateStarted":"2020-05-08T05:58:13-0400","dateFinished":"2020-05-08T05:58:13-0400","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:6485"},{"text":"%spark.pyspark\ndf_user210_movie.count()","user":"yava","dateUpdated":"2020-05-08T05:58:16-0400","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"138\n"}]},"apps":[],"jobName":"paragraph_1588931728489_1151980120","id":"20200508-055528_336151829","dateCreated":"2020-05-08T05:55:28-0400","dateStarted":"2020-05-08T05:58:17-0400","dateFinished":"2020-05-08T05:58:18-0400","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:6486"},{"text":"%spark.pyspark\ndf_user210_movie.show()","user":"yava","dateUpdated":"2020-05-08T05:58:20-0400","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+------+--------------------+------+\n|userId|               title|rating|\n+------+--------------------+------+\n|   210|Batman Forever (1...|   3.5|\n|   210|Star Wars: Episod...|   5.0|\n|   210| Pulp Fiction (1994)|   0.5|\n|   210|    Coneheads (1993)|   1.5|\n|   210|Last Action Hero ...|   3.5|\n|   210|Terminator 2: Jud...|   4.0|\n|   210|Star Wars: Episod...|   5.0|\n|   210|Raiders of the Lo...|   3.0|\n|   210|Star Wars: Episod...|   5.0|\n|   210|Back to the Futur...|   4.5|\n|   210|Star Trek: First ...|   4.5|\n|   210|Fifth Element, Th...|   5.0|\n|   210|      Contact (1997)|   4.0|\n|   210|Back to the Futur...|   4.5|\n|   210|         Tron (1982)|   2.5|\n|   210|  Matrix, The (1999)|   5.0|\n|   210|Star Wars: Episod...|   5.0|\n|   210|Ghostbusters (a.k...|   4.5|\n|   210|Green Mile, The (...|   4.0|\n|   210|Knight's Tale, A ...|   4.5|\n+------+--------------------+------+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1588931739355_-1832083059","id":"20200508-055539_1620779754","dateCreated":"2020-05-08T05:55:39-0400","dateStarted":"2020-05-08T05:58:20-0400","dateFinished":"2020-05-08T05:58:21-0400","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:6487"},{"text":"%md\n\n#11 Menampilkan judul film yang tidak disukai oleh user 210","user":"yava","dateUpdated":"2020-05-08T06:08:01-0400","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<p>#11 Menampilkan judul film yang tidak disukai oleh user 210</p>\n</div>"}]},"apps":[],"jobName":"paragraph_1588932278444_667724951","id":"20200508-060438_1632834518","dateCreated":"2020-05-08T06:04:38-0400","dateStarted":"2020-05-08T06:08:01-0400","dateFinished":"2020-05-08T06:08:01-0400","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:6488"},{"text":"%spark.pyspark\n#yang filem yang paling tidak disukai oleh user210\n\ndf_user210_movie.filter(\"rating <= 2.0\").show(truncate=False)","user":"yava","dateUpdated":"2020-05-08T06:01:18-0400","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+------+----------------------------------+------+\n|userId|title                             |rating|\n+------+----------------------------------+------+\n|210   |Pulp Fiction (1994)               |0.5   |\n|210   |Coneheads (1993)                  |1.5   |\n|210   |Millennium (1989)                 |2.0   |\n|210   |Shark Tale (2004)                 |1.5   |\n|210   |Fire and Ice (2008)               |2.0   |\n|210   |Where the Wild Things Are (2009)  |2.0   |\n|210   |In the Name of the King III (2014)|1.0   |\n|210   |Battle Planet (2008)              |2.0   |\n|210   |Iron Soldier (2010)               |1.0   |\n+------+----------------------------------+------+\n\n"}]},"apps":[],"jobName":"paragraph_1588931915718_707798209","id":"20200508-055835_674893339","dateCreated":"2020-05-08T05:58:35-0400","dateStarted":"2020-05-08T06:01:18-0400","dateFinished":"2020-05-08T06:01:19-0400","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:6489"},{"text":"%md\n\n#12 Menampilkan judul film yang telah paling disukai oleh user 210","user":"yava","dateUpdated":"2020-05-08T06:08:21-0400","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<p>#12 Menampilkan judul film yang telah paling disukai oleh user 210</p>\n</div>"}]},"apps":[],"jobName":"paragraph_1588932487166_-727668450","id":"20200508-060807_263905046","dateCreated":"2020-05-08T06:08:07-0400","dateStarted":"2020-05-08T06:08:21-0400","dateFinished":"2020-05-08T06:08:21-0400","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:6490"},{"text":"%spark.pyspark\n#yang filem yang paling disukai oleh user210\n\ndf_user210_movie.filter(\"rating >= 4.0\").sort(desc(\"rating\")).show(truncate=False)","user":"yava","dateUpdated":"2020-05-08T06:03:03-0400","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+------+-----------------------------------------------------+------+\n|userId|title                                                |rating|\n+------+-----------------------------------------------------+------+\n|210   |Star Wars: Episode VI - Return of the Jedi (1983)    |5.0   |\n|210   |Star Wars: Episode V - The Empire Strikes Back (1980)|5.0   |\n|210   |Star Wars: Episode I - The Phantom Menace (1999)     |5.0   |\n|210   |Star Wars: Episode II - Attack of the Clones (2002)  |5.0   |\n|210   |Star Wars: Episode III - Revenge of the Sith (2005)  |5.0   |\n|210   |Fifth Element, The (1997)                            |5.0   |\n|210   |Star Wars: Episode IV - A New Hope (1977)            |5.0   |\n|210   |How to Train Your Dragon (2010)                      |5.0   |\n|210   |How to Train Your Dragon 2 (2014)                    |5.0   |\n|210   |Guardians of the Galaxy (2014)                       |5.0   |\n|210   |The Imitation Game (2014)                            |5.0   |\n|210   |Star Wars: Episode VII - The Force Awakens (2015)    |5.0   |\n|210   |Guardians of the Galaxy 2 (2017)                     |5.0   |\n|210   |Dragons: Gift of the Night Fury (2011)               |5.0   |\n|210   |Coco (2017)                                          |5.0   |\n|210   |WALL·E (2008)                                        |5.0   |\n|210   |Avatar (2009)                                        |5.0   |\n|210   |Matrix, The (1999)                                   |5.0   |\n|210   |Spider-Man 2 (2004)                                  |4.5   |\n|210   |Serenity (2005)                                      |4.5   |\n+------+-----------------------------------------------------+------+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1588932018371_1285818391","id":"20200508-060018_141981420","dateCreated":"2020-05-08T06:00:18-0400","dateStarted":"2020-05-08T06:03:03-0400","dateFinished":"2020-05-08T06:03:05-0400","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:6491"},{"text":"%spark.pyspark\n","user":"yava","dateUpdated":"2020-05-08T04:19:59-0400","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1588925999220_1170146388","id":"20200508-041959_1129669415","dateCreated":"2020-05-08T04:19:59-0400","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:6492"}],"name":"4. User Analytics the MovieLens Dataset with pySpark and Spark Dataframe","id":"2F6S9TEW7","noteParams":{},"noteForms":{},"angularObjects":{"md:shared_process":[],"hive:yava:":[],"sh:yava:":[],"spark:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}